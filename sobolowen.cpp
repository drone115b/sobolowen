
/*
 * Coded by Mayur Patel
 * Copyright (c) 2023
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 *
 * 1. Redistributions of source code must retain the above copyright notice, this
 *    list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright notice,
 *    this list of conditions and the following disclaimer in the documentation
 *    and/or other materials provided with the distribution.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR
 * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
 * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
 * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
 * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
 * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 *
 * The views and conclusions contained in the software and documentation are those
 * of the authors and should not be interpreted as representing official policies,
 * either expressed or implied, of this project.
 */

#include "sobolowen.h"

const uint32_t sobolowen::_sobolV[MAXDIM][32] = {
{0x80000000,0x40000000,0x20000000,0x10000000,0x8000000,0x4000000,0x2000000,0x1000000,0x800000,0x400000,0x200000,0x100000,0x80000,0x40000,0x20000,0x10000,0x8000,0x4000,0x2000,0x1000,0x800,0x400,0x200,0x100,0x80,0x40,0x20,0x10,0x8,0x4,0x2,0x1},
{0x80000000,0xc0000000,0xa0000000,0xf0000000,0x88000000,0xcc000000,0xaa000000,0xff000000,0x80800000,0xc0c00000,0xa0a00000,0xf0f00000,0x88880000,0xcccc0000,0xaaaa0000,0xffff0000,0x80008000,0xc000c000,0xa000a000,0xf000f000,0x88008800,0xcc00cc00,0xaa00aa00,0xff00ff00,0x80808080,0xc0c0c0c0,0xa0a0a0a0,0xf0f0f0f0,0x88888888,0xcccccccc,0xaaaaaaaa,0xffffffff},
{0x80000000,0xc0000000,0x60000000,0x90000000,0xe8000000,0x5c000000,0x8e000000,0xc5000000,0x68800000,0x9cc00000,0xee600000,0x55900000,0x80680000,0xc09c0000,0x60ee0000,0x90550000,0xe8808000,0x5cc0c000,0x8e606000,0xc5909000,0x6868e800,0x9c9c5c00,0xeeee8e00,0x5555c500,0x8000e880,0xc0005cc0,0x60008e60,0x9000c590,0xe8006868,0x5c009c9c,0x8e00eeee,0xc5005555},
{0x80000000,0xc0000000,0x20000000,0x50000000,0xf8000000,0x74000000,0xa2000000,0x93000000,0xd8800000,0x25400000,0x59e00000,0xe6d00000,0x78080000,0xb40c0000,0x82020000,0xc3050000,0x208f8000,0x51474000,0xfbea2000,0x75d93000,0xa0858800,0x914e5400,0xdbe79e00,0x25db6d00,0x58800080,0xe54000c0,0x79e00020,0xb6d00050,0x800800f8,0xc00c0074,0x200200a2,0x50050093},
{0x80000000,0x40000000,0x20000000,0xb0000000,0xf8000000,0xdc000000,0x7a000000,0x9d000000,0x5a800000,0x2fc00000,0xa1600000,0xf0b00000,0xda880000,0x6fc40000,0x81620000,0x40bb0000,0x22878000,0xb3c9c000,0xfb65a000,0xddb2d000,0x78022800,0x9c0b3c00,0x5a0fb600,0x2d0ddb00,0xa2878080,0xf3c9c040,0xdb65a020,0x6db2d0b0,0x800228f8,0x400b3cdc,0x200fb67a,0xb00ddb9d},
{0x80000000,0x40000000,0x60000000,0x30000000,0xc8000000,0x24000000,0x56000000,0xfb000000,0xe0800000,0x70400000,0xa8600000,0x14300000,0x9ec80000,0xdf240000,0xb6d60000,0x8bbb0000,0x48008000,0x64004000,0x36006000,0xcb003000,0x2880c800,0x54402400,0xfe605600,0xef30fb00,0x7e48e080,0xaf647040,0x1eb6a860,0x9f8b1430,0xd6c81ec8,0xbb249f24,0x80d6d6d6,0x40bbbbbb},
{0x80000000,0xc0000000,0xa0000000,0xd0000000,0x58000000,0x94000000,0x3e000000,0xe3000000,0xbe800000,0x23c00000,0x1e200000,0xf3100000,0x46780000,0x67840000,0x78460000,0x84670000,0xc6788000,0xa784c000,0xd846a000,0x5467d000,0x9e78d800,0x33845400,0xe6469e00,0xb7673300,0x20f86680,0x104477c0,0xf8668020,0x4477c010,0x668020f8,0x77c01044,0x8020f866,0xc0104477},
{0x80000000,0x40000000,0xa0000000,0x50000000,0x88000000,0x24000000,0x12000000,0x2d000000,0x76800000,0x9e400000,0x8200000,0x64100000,0xb2280000,0x7d140000,0xfea20000,0xba490000,0x1a248000,0x491b4000,0xc4b5a000,0xe3739000,0xf6800800,0xde400400,0xa8200a00,0x34100500,0x3a280880,0x59140240,0xeca20120,0x974902d0,0x6ca48768,0xd75b49e4,0xcc95a082,0x87639641},
{0x80000000,0x40000000,0xa0000000,0x50000000,0x28000000,0xd4000000,0x6a000000,0x71000000,0x38800000,0x58400000,0xea200000,0x31100000,0x98a80000,0x8540000,0xc22a0000,0xe5250000,0xf2b28000,0x79484000,0xfaa42000,0xbd731000,0x18a80800,0x48540400,0x622a0a00,0xb5250500,0xdab28280,0xad484d40,0x90a426a0,0xcc731710,0x20280b88,0x10140184,0x880a04a2,0x84350611},
{0x80000000,0x40000000,0xe0000000,0xb0000000,0x98000000,0x94000000,0x8a000000,0x5b000000,0x33800000,0xd9c00000,0x72200000,0x3f100000,0xc1b80000,0xa6ec0000,0x53860000,0x29f50000,0xa3a8000,0x1b2ac000,0xd392e000,0x69ff7000,0xea380800,0xab2c0400,0x4ba60e00,0xfde50b00,0x60028980,0xf006c940,0x7834e8a0,0x241a75b0,0x123a8b38,0xcf2ac99c,0xb992e922,0x82ff78f1},
{0x80000000,0x40000000,0xa0000000,0x10000000,0x8000000,0x6c000000,0x9e000000,0x23000000,0x57800000,0xadc00000,0x7fa00000,0x91d00000,0x49880000,0xced40000,0x880a0000,0x2c0f0000,0x3e0d8000,0x3317c000,0x5fb06000,0xc1f8b000,0xe18d8800,0xb2d7c400,0x1e106a00,0x6328b100,0xf7858880,0xbdc3c2c0,0x77ba63e0,0xfdf7b330,0xd7800df8,0xedc0081c,0xdfa0041a,0x81d00a2d},
{0x80000000,0x40000000,0x20000000,0x30000000,0x58000000,0xac000000,0x96000000,0x2b000000,0xd4800000,0x9400000,0xe2a00000,0x52500000,0x4e280000,0xc71c0000,0x629e0000,0x12670000,0x6e138000,0xf731c000,0x3a98a000,0xbe449000,0xf83b8800,0xdc2dc400,0xee06a200,0xb7239300,0x1aa80d80,0x8e5c0ec0,0xa03e0b60,0x703701b0,0x783b88c8,0x9c2dca54,0xce06a74a,0x87239795},
{0x80000000,0xc0000000,0xa0000000,0x50000000,0xf8000000,0x8c000000,0xe2000000,0x33000000,0xf800000,0x21400000,0x95a00000,0x5e700000,0xd8080000,0x1c240000,0xba160000,0xef370000,0x15868000,0x9e6fc000,0x781b6000,0x4c349000,0x420e8800,0x630bcc00,0xf7ad6a00,0xad739500,0x77800780,0x6d4004c0,0xd7a00420,0x3d700630,0x2f880f78,0xb1640ad4,0xcdb6077a,0x824706d7},
{0x80000000,0xc0000000,0x60000000,0x90000000,0x38000000,0xc4000000,0x42000000,0xa3000000,0xf1800000,0xaa400000,0xfce00000,0x85100000,0xe0080000,0x500c0000,0x58060000,0x54090000,0x7a038000,0x670c4000,0xb3842000,0x94a3000,0xd6f1800,0x2f5aa400,0x1ce7ce00,0xd5145100,0xb8000080,0x40000c0,0x22000060,0x33000090,0xc9800038,0x6e4000c4,0xbee00042,0x261000a3},
{0x80000000,0x40000000,0x20000000,0xf0000000,0xa8000000,0x54000000,0x9a000000,0x9d000000,0x1e800000,0x5cc00000,0x7d200000,0x8d100000,0x24880000,0x71c40000,0xeba20000,0x75df0000,0x6ba28000,0x35d14000,0x4ba3a000,0xc5d2d000,0xe3a16800,0x91db8c00,0x79aef200,0xcdf4100,0x672a8080,0x50154040,0x1a01a020,0xdd0dd0f0,0x3e83e8a8,0xaccacc54,0xd52d529a,0xd91d919d},
{0x80000000,0xc0000000,0x20000000,0xd0000000,0xd8000000,0xc4000000,0x46000000,0x85000000,0xa5800000,0x76c00000,0xada00000,0x6ab00000,0x2da80000,0xaabc0000,0xdaa0000,0x7ab10000,0xd5a78000,0xbebd4000,0x93a3e000,0x3bb51000,0x3629b800,0x4d727c00,0x9b836200,0x27c4d700,0xb629b880,0x8d727cc0,0xbb836220,0xf7c4d7d0,0x6e29b858,0x49727c04,0xfd836266,0x72c4d755},
{0x80000000,0x40000000,0x20000000,0xf0000000,0x38000000,0x14000000,0xf6000000,0x67000000,0x8f800000,0x50400000,0x8aa00000,0xff00000,0x12a80000,0xabf40000,0xfcaa0000,0x28fb0000,0xbd298000,0xbba4000,0x4e06e000,0x330c3000,0x59861800,0xc74d3400,0x3d2cb200,0x4bb2cb00,0x6e061880,0xc30d3440,0x618cb220,0xd342cbf0,0xcb2e18b8,0x2cb93454,0xe186b2d6,0x9349cb97},
{0x80000000,0xc0000000,0x20000000,0xf0000000,0x68000000,0x64000000,0x36000000,0x6d000000,0x41800000,0xe0400000,0xd2e00000,0x9bf00000,0xce80000,0x52fc0000,0x5b6a0000,0x2fb30000,0xa00c8000,0x30054000,0x4807e000,0x940f9000,0x5e01f800,0x90e9400,0x778a5600,0x8d416b00,0x9369f880,0x7bb294c0,0xde005620,0xc9026bf0,0x578d78e8,0x7d4bd4a4,0xfb6db616,0x1fbefb9d},
{0x80000000,0x40000000,0xa0000000,0x50000000,0x98000000,0xf4000000,0xae000000,0xbb000000,0xe7800000,0x95c00000,0x1c200000,0xd0300000,0xdba80000,0x55f40000,0xff820000,0x21c10000,0x12238000,0x3b3a4000,0xa42b6000,0x3430f000,0x4da69800,0x4af3ec00,0x2e043a00,0xfb0a1f00,0x47851880,0xc5c9ac40,0x842f5aa0,0x243aef50,0x75a38018,0xeefa40b4,0x180b600e,0xb400f0eb},
{0x80000000,0xc0000000,0xe0000000,0xb0000000,0xb8000000,0x3c000000,0xce000000,0x41000000,0x21800000,0x51c00000,0x9600000,0x85700000,0xf2780000,0x8e9c0000,0x60020000,0x70030000,0x58038000,0x8c02c000,0x7602e000,0x7d00f000,0xef833800,0x10c10400,0x28e08600,0xd4b14700,0xfb182580,0xbee15c0,0x9279c9e0,0xfe9d3a70,0x38000008,0xfc00000c,0x2e00000e,0xf100000b},
{0x80000000,0xc0000000,0xe0000000,0xd0000000,0x68000000,0x3c000000,0x8a000000,0x51000000,0xa9800000,0xddc00000,0x5ba00000,0x39d00000,0x95f80000,0x56d40000,0xa020000,0x91030000,0x49838000,0xdc34000,0x33a1a000,0x5d0f000,0x1ffa2800,0x7d54400,0xa380a600,0x4cc07700,0x1222ee80,0x3413a740,0xa65bf7e0,0x5305ab50,0x15f80008,0x96d4000c,0xea02000e,0x4103000d},
{0x80000000,0x40000000,0x60000000,0xd0000000,0x38000000,0x8c000000,0x7e000000,0x71000000,0xc8800000,0x4c00000,0x1ba00000,0xbb700000,0x4a980000,0xc3bc0000,0xa6020000,0x6d010000,0xee818000,0x29c34000,0x9520e000,0x42b23000,0xe7b9f800,0xd0dc400,0x3fb92200,0x110d1300,0x19bbee80,0x3c0cadc0,0x973a4a60,0xc5cf7ef0,0x3a180008,0xb7c0004,0xa3a20006,0x7771000d},
{0x80000000,0xc0000000,0xa0000000,0x90000000,0x8000000,0x64000000,0x6a000000,0x89000000,0xa5800000,0xcb400000,0x18200000,0xad900000,0xaf880000,0x72f40000,0x25820000,0xb430000,0xb8228000,0x3d924000,0xa7882000,0x16f59000,0x4f83a800,0x82412400,0x1da01600,0xf6d16d00,0xbfa84080,0xbb672640,0xe0091620,0xf0b4efd0,0x38228008,0xfd92400c,0x788200a,0x86f59009},
{0x80000000,0xc0000000,0x20000000,0xd0000000,0x48000000,0x8c000000,0xd6000000,0x39000000,0xd5800000,0x32400000,0xb2a00000,0x72100000,0x53d80000,0x82cc0000,0xcb820000,0x47430000,0x91208000,0xa9534000,0x7cf92000,0x4e9e3000,0xfcf95800,0x8e9fe400,0xdcf9d600,0x5e9c8900,0x94f96a80,0xd29fb840,0x42f9b760,0xeb9c9f30,0x97788008,0xd9df400c,0x25db2002,0xabcd300d},
{0x80000000,0xc0000000,0x20000000,0x50000000,0xd8000000,0xf4000000,0x3e000000,0x95000000,0x8f800000,0x3d400000,0xf3200000,0x2ef00000,0xadc80000,0xa0c0000,0x8b220000,0x4af30000,0x6bc88000,0x3b0d4000,0xe2a16000,0x16b0d000,0x29687800,0xbdbf1400,0x33cb5e00,0xf0c2500,0xfca1b480,0xd3b0afc0,0x7eeb6920,0x74fe4d30,0xfee87808,0xb4ff140c,0xdeeb5e02,0xe4fc2505},
{0x80000000,0x40000000,0xa0000000,0xb0000000,0x98000000,0xa4000000,0x7a000000,0xd5000000,0x2800000,0x60400000,0x51e00000,0x88700000,0x8c280000,0x47c40000,0xbe20000,0xad710000,0xb6aa8000,0x3386c000,0xb8006000,0x54039000,0x42036800,0xc1019400,0xe0826a00,0x11431100,0x2960af80,0x3d3175c0,0xdf4a3aa0,0xaff49e10,0xd62b6808,0x62c59404,0x31606a0a,0xd932110b},
{0x80000000,0xc0000000,0xa0000000,0x30000000,0x18000000,0x34000000,0x8a000000,0x9d000000,0x67800000,0x82400000,0x40e00000,0x60f00000,0x91480000,0x29440000,0x2d620000,0xbfb30000,0x162a8000,0xfbf4c000,0xe4ca6000,0xc207d000,0x2002a800,0xf001b400,0xb8037e00,0x4021900,0x92034b80,0xa90327c0,0xed81f320,0x1f40d810,0x27602808,0xe2b1740c,0xd1ab1e0a,0x49b6c903},
{0x80000000,0x40000000,0xe0000000,0xd0000000,0x8000000,0x4c000000,0x2000000,0xb5000000,0x36800000,0xc2c00000,0x14200000,0x7500000,0x1bf80000,0x50340000,0x48a20000,0xac910000,0xd35b8000,0xbca74000,0x7bfa2000,0xc0343000,0xa0a18800,0x30909400,0xd95b7a00,0x45a57b00,0x4f7a7880,0xb7f6f940,0x82013de0,0xf502dfd0,0xd6820808,0x12c3d404,0x1c235a0e,0x4b504b0d},
{0x80000000,0xc0000000,0xe0000000,0x50000000,0x68000000,0x4c000000,0x76000000,0xf7000000,0x36800000,0xd7400000,0x87e00000,0xef300000,0xa3a80000,0xd5440000,0x23aa0000,0x15470000,0xc3a98000,0x45464000,0xaba82000,0x9477000,0xdda9f800,0xfe44ac00,0xeb292200,0x2907f100,0x6ccb3d80,0xc6344dc0,0xcf61b320,0x137318d0,0xeccb3d88,0x6344dcc,0x2f61b32e,0x437318d5},
{0x80000000,0x40000000,0x60000000,0x90000000,0xc8000000,0x74000000,0x52000000,0x3000000,0xeb800000,0x6f400000,0x64600000,0xdaf00000,0x17980000,0x297c0000,0xa59a0000,0xfa7d0000,0xe61b8000,0x713f4000,0x1878a000,0xdcce9000,0xb661e800,0x99f29c00,0x9c184600,0xd63e2100,0x9fa5780,0x548e0ac0,0xa380a9e0,0x5b413f30,0x56625788,0x49f20ac4,0x341aa9e6,0x323c3f39},
{0x80000000,0xc0000000,0xa0000000,0xd0000000,0xb8000000,0x4000000,0x6e000000,0x97000000,0xf2800000,0xedc00000,0x13600000,0x5c900000,0xdb580000,0x31e40000,0x9da0000,0xcc270000,0x2b88000,0x44b44000,0xfe26000,0xe6505000,0x9ab9d800,0x50b50c00,0x79e29200,0xa552fb00,0xbe38bf80,0x2e77d940,0xf6000ae0,0x830112d0,0x84803f88,0xaec3994c,0x37e26aea,0x225142dd},
{0x80000000,0xc0000000,0xe0000000,0x30000000,0x68000000,0xec000000,0x22000000,0x2b000000,0x36800000,0x9d400000,0x6a200000,0x16700000,0x4de80000,0x330c0000,0x936a0000,0x824f0000,0x3b498000,0x8f3fc000,0x28202000,0xcd707000,0xf36aa800,0x724fdc00,0xb34bf200,0x533e6900,0x62207a80,0xa7140c0,0xe7ea6520,0xc40d90f0,0xefe9fa88,0xd80e80cc,0x45ea452e,0x2f0de0f3},
};

const uint8_t scramble_table[16][128] = {
  {0xf,0xe,0xc,0xd,0xc,0xd,0xe,0xf,0x9,0x9,0x8,0x8,0xa,0xa,0xb,0xb,0x2,0x3,0x3,0x2,0x0,0x0,0x1,0x1,0x7,0x6,0x4,0x5,0x7,0x7,0x4,0x4,0x37,0x36,0x35,0x34,0x30,0x31,0x32,0x33,0x3c,0x3d,0x3d,0x3c,0x3b,0x3a,0x3a,0x3b,0x30,0x31,0x32,0x33,0x35,0x34,0x37,0x36,0x3c,0x3c,0x3f,0x3f,0x3b,0x3b,0x38,0x38,0x7a,0x7b,0x7a,0x7b,0x7c,0x7d,0x7d,0x7c,0x70,0x70,0x73,0x73,0x75,0x74,0x77,0x76,0x67,0x66,0x64,0x65,0x65,0x65,0x66,0x66,0x68,0x69,0x6b,0x6a,0x6b,0x6a,0x68,0x69,0x50,0x50,0x51,0x51,0x56,0x57,0x56,0x57,0x5f,0x5f,0x5c,0x5c,0x5b,0x5a,0x59,0x58,0x46,0x47,0x45,0x44,0x42,0x42,0x41,0x41,0x4d,0x4d,0x4e,0x4e,0x4b,0x4a,0x48,0x49},
  {0xba,0xba,0xb9,0xb9,0xbd,0xbd,0xbe,0xbe,0xbf,0xbe,0xbd,0xbc,0xbb,0xba,0xb8,0xb9,0xa1,0xa0,0xa2,0xa3,0xa2,0xa2,0xa1,0xa1,0xa4,0xa5,0xa4,0xa5,0xa7,0xa7,0xa6,0xa6,0x86,0x87,0x85,0x84,0x83,0x82,0x81,0x80,0x83,0x83,0x80,0x80,0x85,0x84,0x87,0x86,0x98,0x99,0x9b,0x9a,0x9c,0x9d,0x9e,0x9f,0x9a,0x9a,0x9b,0x9b,0x9d,0x9c,0x9c,0x9d,0xe8,0xe8,0xeb,0xeb,0xed,0xed,0xee,0xee,0xe3,0xe2,0xe1,0xe0,0xe6,0xe7,0xe5,0xe4,0xf9,0xf8,0xfa,0xfb,0xfe,0xff,0xfc,0xfd,0xf7,0xf6,0xf6,0xf7,0xf0,0xf1,0xf1,0xf0,0xdf,0xde,0xdd,0xdc,0xdd,0xdd,0xde,0xde,0xd8,0xd8,0xd9,0xd9,0xda,0xdb,0xda,0xdb,0xc0,0xc0,0xc3,0xc3,0xc2,0xc3,0xc1,0xc0,0xc4,0xc5,0xc6,0xc7,0xc5,0xc5,0xc6,0xc6},
  {0xa6,0xa7,0xa6,0xa7,0xa5,0xa4,0xa5,0xa4,0xab,0xaa,0xa8,0xa9,0xa8,0xa9,0xab,0xaa,0xae,0xae,0xaf,0xaf,0xa9,0xa8,0xa8,0xa9,0xa7,0xa7,0xa4,0xa4,0xa0,0xa1,0xa3,0xa2,0xb9,0xb8,0xb9,0xb8,0xbe,0xbf,0xbe,0xbf,0xb2,0xb3,0xb1,0xb0,0xb6,0xb7,0xb4,0xb5,0xb1,0xb0,0xb3,0xb2,0xb7,0xb6,0xb4,0xb5,0xbd,0xbd,0xbe,0xbe,0xb8,0xb8,0xbb,0xbb,0xd0,0xd0,0xd3,0xd3,0xd6,0xd7,0xd5,0xd4,0xd5,0xd4,0xd4,0xd5,0xd3,0xd2,0xd3,0xd2,0xc8,0xc9,0xca,0xcb,0xc9,0xc9,0xca,0xca,0xce,0xce,0xcf,0xcf,0xcc,0xcd,0xcc,0xcd,0xdf,0xdf,0xdc,0xdc,0xdb,0xda,0xd9,0xd8,0xd6,0xd7,0xd5,0xd4,0xd1,0xd0,0xd2,0xd3,0xc3,0xc3,0xc2,0xc2,0xc5,0xc4,0xc4,0xc5,0xc8,0xc8,0xc9,0xc9,0xce,0xcf,0xcf,0xce},
  {0x22,0x23,0x23,0x22,0x25,0x24,0x24,0x25,0x25,0x25,0x26,0x26,0x22,0x22,0x21,0x21,0x3f,0x3e,0x3c,0x3d,0x3c,0x3d,0x3f,0x3e,0x38,0x39,0x38,0x39,0x3b,0x3a,0x3b,0x3a,0x2e,0x2e,0x2d,0x2d,0x2b,0x2b,0x28,0x28,0x20,0x21,0x22,0x23,0x25,0x24,0x26,0x27,0x39,0x39,0x3a,0x3a,0x3e,0x3f,0x3d,0x3c,0x32,0x32,0x33,0x33,0x35,0x34,0x35,0x34,0x4a,0x4a,0x49,0x49,0x4d,0x4c,0x4f,0x4e,0x42,0x43,0x43,0x42,0x44,0x45,0x44,0x45,0x5d,0x5c,0x5c,0x5d,0x5b,0x5b,0x5a,0x5a,0x55,0x54,0x56,0x57,0x50,0x51,0x53,0x52,0x54,0x55,0x56,0x57,0x53,0x53,0x50,0x50,0x53,0x52,0x51,0x50,0x56,0x56,0x55,0x55,0x48,0x48,0x4b,0x4b,0x48,0x49,0x4a,0x4b,0x4f,0x4e,0x4c,0x4d,0x4e,0x4f,0x4d,0x4c},
  {0x86,0x87,0x87,0x86,0x80,0x81,0x80,0x81,0x8f,0x8e,0x8d,0x8c,0x88,0x88,0x8b,0x8b,0x90,0x91,0x90,0x91,0x97,0x96,0x97,0x96,0x98,0x98,0x9b,0x9b,0x9f,0x9f,0x9c,0x9c,0x99,0x98,0x9a,0x9b,0x98,0x99,0x9b,0x9a,0x96,0x96,0x95,0x95,0x95,0x95,0x96,0x96,0x8a,0x8b,0x89,0x88,0x8f,0x8e,0x8c,0x8d,0x86,0x87,0x86,0x87,0x81,0x80,0x81,0x80,0xba,0xbb,0xb9,0xb8,0xbe,0xbe,0xbd,0xbd,0xb3,0xb2,0xb2,0xb3,0xb4,0xb5,0xb4,0xb5,0xa3,0xa3,0xa0,0xa0,0xa5,0xa4,0xa7,0xa6,0xad,0xac,0xad,0xac,0xaa,0xab,0xab,0xaa,0xac,0xad,0xae,0xaf,0xaa,0xaa,0xa9,0xa9,0xad,0xac,0xae,0xaf,0xa9,0xa9,0xaa,0xaa,0xb2,0xb3,0xb2,0xb3,0xb1,0xb1,0xb0,0xb0,0xb6,0xb7,0xb5,0xb4,0xb5,0xb4,0xb6,0xb7},
  {0x12,0x12,0x11,0x11,0x10,0x11,0x12,0x13,0x17,0x16,0x17,0x16,0x15,0x14,0x14,0x15,0xf,0xf,0xc,0xc,0xc,0xc,0xf,0xf,0xb,0xa,0x9,0x8,0xb,0xa,0x8,0x9,0x3c,0x3d,0x3d,0x3c,0x3a,0x3b,0x3a,0x3b,0x3c,0x3d,0x3e,0x3f,0x3b,0x3b,0x38,0x38,0x21,0x20,0x23,0x22,0x24,0x24,0x27,0x27,0x26,0x27,0x27,0x26,0x21,0x20,0x20,0x21,0x63,0x62,0x61,0x60,0x67,0x67,0x64,0x64,0x6f,0x6e,0x6c,0x6d,0x68,0x69,0x6b,0x6a,0x72,0x73,0x72,0x73,0x74,0x74,0x75,0x75,0x78,0x78,0x79,0x79,0x7f,0x7f,0x7e,0x7e,0x49,0x48,0x4b,0x4a,0x4a,0x4b,0x49,0x48,0x44,0x45,0x46,0x47,0x45,0x44,0x46,0x47,0x56,0x56,0x57,0x57,0x50,0x51,0x50,0x51,0x5d,0x5c,0x5e,0x5f,0x5b,0x5b,0x58,0x58},
  {0x67,0x67,0x66,0x66,0x65,0x64,0x65,0x64,0x63,0x62,0x60,0x61,0x60,0x61,0x62,0x63,0x7f,0x7e,0x7d,0x7c,0x79,0x79,0x7a,0x7a,0x7c,0x7d,0x7d,0x7c,0x7a,0x7a,0x7b,0x7b,0x42,0x43,0x40,0x41,0x43,0x42,0x40,0x41,0x4d,0x4c,0x4e,0x4f,0x4d,0x4c,0x4f,0x4e,0x5c,0x5d,0x5f,0x5e,0x5b,0x5b,0x58,0x58,0x52,0x52,0x53,0x53,0x54,0x55,0x54,0x55,0x12,0x13,0x10,0x11,0x12,0x12,0x11,0x11,0x1f,0x1f,0x1c,0x1c,0x1d,0x1c,0x1f,0x1e,0x12,0x13,0x13,0x12,0x15,0x14,0x14,0x15,0x18,0x18,0x1b,0x1b,0x1e,0x1f,0x1d,0x1c,0x24,0x25,0x24,0x25,0x23,0x22,0x23,0x22,0x2d,0x2d,0x2e,0x2e,0x29,0x28,0x2a,0x2b,0x29,0x29,0x28,0x28,0x2e,0x2e,0x2f,0x2f,0x25,0x24,0x27,0x26,0x22,0x23,0x20,0x21},
  {0x66,0x67,0x64,0x65,0x64,0x64,0x67,0x67,0x69,0x69,0x68,0x68,0x6b,0x6a,0x6b,0x6a,0x71,0x70,0x72,0x73,0x74,0x75,0x76,0x77,0x7a,0x7b,0x7b,0x7a,0x7d,0x7d,0x7c,0x7c,0x56,0x56,0x55,0x55,0x51,0x50,0x53,0x52,0x54,0x55,0x54,0x55,0x53,0x53,0x52,0x52,0x4f,0x4e,0x4d,0x4c,0x4a,0x4b,0x49,0x48,0x48,0x48,0x4b,0x4b,0x4f,0x4e,0x4c,0x4d,0x14,0x15,0x16,0x17,0x12,0x13,0x11,0x10,0x1f,0x1f,0x1c,0x1c,0x1b,0x1a,0x18,0x19,0x1a,0x1a,0x1b,0x1b,0x1d,0x1c,0x1d,0x1c,0x10,0x11,0x13,0x12,0x15,0x14,0x17,0x16,0x24,0x24,0x25,0x25,0x27,0x27,0x26,0x26,0x23,0x22,0x20,0x21,0x20,0x21,0x22,0x23,0x29,0x28,0x2a,0x2b,0x2e,0x2f,0x2c,0x2d,0x2e,0x2e,0x2d,0x2d,0x28,0x29,0x2b,0x2a},
  {0xbe,0xbf,0xbc,0xbd,0xbd,0xbc,0xbf,0xbe,0xb2,0xb3,0xb3,0xb2,0xb1,0xb1,0xb0,0xb0,0xa2,0xa2,0xa1,0xa1,0xa2,0xa3,0xa1,0xa0,0xaf,0xaf,0xae,0xae,0xac,0xad,0xac,0xad,0xb1,0xb0,0xb2,0xb3,0xb5,0xb4,0xb7,0xb6,0xb8,0xb9,0xba,0xbb,0xbf,0xbe,0xbd,0xbc,0xad,0xad,0xac,0xac,0xab,0xaa,0xaa,0xab,0xa2,0xa3,0xa1,0xa0,0xa4,0xa4,0xa7,0xa7,0xc2,0xc2,0xc1,0xc1,0xc4,0xc5,0xc6,0xc7,0xcf,0xce,0xcf,0xce,0xc9,0xc9,0xc8,0xc8,0xc9,0xc8,0xca,0xcb,0xc8,0xc9,0xcb,0xca,0xc6,0xc7,0xc4,0xc5,0xc7,0xc6,0xc4,0xc5,0xd8,0xd9,0xd9,0xd8,0xdf,0xde,0xdf,0xde,0xd1,0xd1,0xd2,0xd2,0xd6,0xd6,0xd5,0xd5,0xdf,0xde,0xdc,0xdd,0xd8,0xd9,0xda,0xdb,0xd4,0xd5,0xd5,0xd4,0xd3,0xd2,0xd3,0xd2},
  {0xe0,0xe1,0xe3,0xe2,0xe0,0xe1,0xe2,0xe3,0xe7,0xe6,0xe5,0xe4,0xe5,0xe4,0xe6,0xe7,0xfd,0xfd,0xfe,0xfe,0xf8,0xf9,0xfb,0xfa,0xfb,0xfa,0xf8,0xf9,0xfe,0xfe,0xfd,0xfd,0xe9,0xe8,0xe9,0xe8,0xee,0xef,0xee,0xef,0xe1,0xe0,0xe2,0xe3,0xe6,0xe7,0xe5,0xe4,0xfa,0xfb,0xfa,0xfb,0xfc,0xfc,0xfd,0xfd,0xf7,0xf6,0xf5,0xf4,0xf1,0xf1,0xf2,0xf2,0x9c,0x9d,0x9d,0x9c,0x9b,0x9b,0x9a,0x9a,0x95,0x94,0x97,0x96,0x92,0x92,0x91,0x91,0x8f,0x8e,0x8c,0x8d,0x8c,0x8d,0x8e,0x8f,0x81,0x80,0x83,0x82,0x80,0x80,0x83,0x83,0x8a,0x8b,0x88,0x89,0x8b,0x8b,0x88,0x88,0x8e,0x8f,0x8f,0x8e,0x8d,0x8c,0x8c,0x8d,0x91,0x90,0x90,0x91,0x97,0x96,0x97,0x96,0x96,0x97,0x96,0x97,0x90,0x91,0x91,0x90},
  {0x90,0x91,0x93,0x92,0x95,0x95,0x96,0x96,0x98,0x98,0x9b,0x9b,0x9e,0x9f,0x9c,0x9d,0x98,0x99,0x9a,0x9b,0x9f,0x9e,0x9d,0x9c,0x97,0x96,0x94,0x95,0x91,0x91,0x92,0x92,0x8e,0x8e,0x8d,0x8d,0x8e,0x8f,0x8d,0x8c,0x81,0x80,0x82,0x83,0x80,0x81,0x83,0x82,0x81,0x81,0x80,0x80,0x82,0x83,0x82,0x83,0x8e,0x8e,0x8f,0x8f,0x8d,0x8c,0x8d,0x8c,0xff,0xff,0xfc,0xfc,0xf8,0xf9,0xfb,0xfa,0xf3,0xf2,0xf1,0xf0,0xf6,0xf7,0xf4,0xf5,0xe4,0xe4,0xe7,0xe7,0xe1,0xe0,0xe2,0xe3,0xec,0xed,0xef,0xee,0xeb,0xea,0xe9,0xe8,0xfa,0xfa,0xfb,0xfb,0xf9,0xf8,0xf8,0xf9,0xf4,0xf5,0xf4,0xf5,0xf7,0xf7,0xf6,0xf6,0xef,0xef,0xec,0xec,0xef,0xee,0xed,0xec,0xe3,0xe2,0xe0,0xe1,0xe0,0xe1,0xe3,0xe2},
  {0x56,0x56,0x55,0x55,0x51,0x50,0x53,0x52,0x50,0x51,0x52,0x53,0x55,0x54,0x56,0x57,0x5b,0x5b,0x5a,0x5a,0x5d,0x5c,0x5d,0x5c,0x5e,0x5f,0x5d,0x5c,0x5a,0x5a,0x59,0x59,0x62,0x63,0x60,0x61,0x65,0x64,0x66,0x67,0x68,0x69,0x6a,0x6b,0x6c,0x6c,0x6f,0x6f,0x6d,0x6c,0x6d,0x6c,0x6f,0x6f,0x6e,0x6e,0x60,0x61,0x63,0x62,0x63,0x62,0x60,0x61,0x19,0x18,0x1b,0x1a,0x1a,0x1b,0x18,0x19,0x15,0x15,0x14,0x14,0x16,0x16,0x17,0x17,0xd,0xc,0xe,0xf,0x8,0x9,0xb,0xa,0x7,0x6,0x6,0x7,0x0,0x1,0x1,0x0,0x23,0x23,0x20,0x20,0x24,0x24,0x27,0x27,0x27,0x26,0x25,0x24,0x22,0x23,0x20,0x21,0x3e,0x3e,0x3f,0x3f,0x3c,0x3d,0x3c,0x3d,0x38,0x39,0x3b,0x3a,0x3b,0x3b,0x38,0x38},
  {0xb5,0xb5,0xb6,0xb6,0xb4,0xb5,0xb6,0xb7,0xba,0xba,0xbb,0xbb,0xb8,0xb9,0xb9,0xb8,0xaf,0xaf,0xac,0xac,0xaa,0xaa,0xa9,0xa9,0xa5,0xa4,0xa7,0xa6,0xa2,0xa3,0xa1,0xa0,0xa3,0xa2,0xa2,0xa3,0xa0,0xa1,0xa0,0xa1,0xa6,0xa6,0xa5,0xa5,0xa5,0xa4,0xa6,0xa7,0xb8,0xb9,0xbb,0xba,0xbd,0xbd,0xbe,0xbe,0xb9,0xb8,0xb9,0xb8,0xbe,0xbf,0xbe,0xbf,0xde,0xde,0xdd,0xdd,0xda,0xdb,0xd9,0xd8,0xd5,0xd4,0xd6,0xd7,0xd3,0xd2,0xd1,0xd0,0xc1,0xc1,0xc0,0xc0,0xc6,0xc7,0xc6,0xc7,0xcc,0xcd,0xcf,0xce,0xc9,0xc8,0xca,0xcb,0xd6,0xd7,0xd6,0xd7,0xd1,0xd1,0xd0,0xd0,0xda,0xda,0xd9,0xd9,0xdd,0xdc,0xdf,0xde,0xca,0xca,0xc9,0xc9,0xcb,0xca,0xc8,0xc9,0xc7,0xc7,0xc4,0xc4,0xc5,0xc4,0xc7,0xc6},
  {0x63,0x62,0x63,0x62,0x65,0x64,0x64,0x65,0x6e,0x6f,0x6d,0x6c,0x68,0x68,0x6b,0x6b,0x70,0x70,0x73,0x73,0x71,0x70,0x72,0x73,0x7f,0x7f,0x7e,0x7e,0x7c,0x7d,0x7d,0x7c,0x58,0x59,0x58,0x59,0x5f,0x5e,0x5f,0x5e,0x5b,0x5a,0x59,0x58,0x5e,0x5f,0x5c,0x5d,0x45,0x44,0x46,0x47,0x42,0x43,0x41,0x40,0x43,0x43,0x40,0x40,0x44,0x44,0x47,0x47,0x78,0x79,0x79,0x78,0x7e,0x7f,0x7e,0x7f,0x7a,0x7a,0x79,0x79,0x7d,0x7c,0x7f,0x7e,0x63,0x62,0x60,0x61,0x67,0x67,0x64,0x64,0x64,0x64,0x67,0x67,0x61,0x60,0x63,0x62,0x48,0x49,0x4b,0x4a,0x4a,0x4b,0x48,0x49,0x47,0x46,0x46,0x47,0x45,0x45,0x44,0x44,0x5f,0x5e,0x5f,0x5e,0x59,0x58,0x58,0x59,0x54,0x54,0x57,0x57,0x51,0x51,0x52,0x52},
  {0x27,0x26,0x27,0x26,0x20,0x20,0x21,0x21,0x25,0x24,0x26,0x27,0x20,0x21,0x22,0x23,0x38,0x38,0x39,0x39,0x3f,0x3e,0x3e,0x3f,0x3a,0x3b,0x38,0x39,0x3c,0x3d,0x3f,0x3e,0x13,0x13,0x12,0x12,0x11,0x10,0x11,0x10,0x1c,0x1d,0x1e,0x1f,0x1c,0x1c,0x1f,0x1f,0x2,0x3,0x1,0x0,0x7,0x7,0x4,0x4,0xd,0xc,0xf,0xe,0xb,0xa,0x8,0x9,0x7f,0x7e,0x7d,0x7c,0x7a,0x7b,0x79,0x78,0x79,0x78,0x7a,0x7b,0x7e,0x7f,0x7c,0x7d,0x72,0x72,0x73,0x73,0x75,0x75,0x74,0x74,0x75,0x74,0x76,0x77,0x70,0x71,0x72,0x73,0x4a,0x4b,0x49,0x48,0x49,0x49,0x4a,0x4a,0x44,0x44,0x45,0x45,0x47,0x46,0x47,0x46,0x45,0x45,0x46,0x46,0x43,0x42,0x41,0x40,0x4e,0x4f,0x4f,0x4e,0x49,0x48,0x48,0x49},
  {0x65,0x64,0x66,0x67,0x65,0x64,0x67,0x66,0x6a,0x6a,0x69,0x69,0x6b,0x6b,0x68,0x68,0x61,0x60,0x60,0x61,0x62,0x62,0x63,0x63,0x6c,0x6d,0x6e,0x6f,0x6f,0x6f,0x6c,0x6c,0x72,0x73,0x71,0x70,0x75,0x74,0x77,0x76,0x7e,0x7f,0x7d,0x7c,0x7b,0x7a,0x79,0x78,0x7d,0x7c,0x7e,0x7f,0x79,0x79,0x7a,0x7a,0x72,0x72,0x73,0x73,0x74,0x75,0x74,0x75,0x11,0x10,0x10,0x11,0x13,0x13,0x12,0x12,0x1f,0x1e,0x1d,0x1c,0x1c,0x1c,0x1f,0x1f,0x4,0x5,0x6,0x7,0x4,0x5,0x7,0x6,0x9,0x9,0xa,0xa,0xa,0xa,0x9,0x9,0xb,0xa,0xb,0xa,0xc,0xd,0xd,0xc,0x7,0x6,0x4,0x5,0x2,0x3,0x0,0x1,0x1c,0x1d,0x1f,0x1e,0x1a,0x1a,0x19,0x19,0x10,0x11,0x12,0x13,0x15,0x14,0x16,0x17},
  // distr: ([123, 127, 131, 127, 132, 130, 126, 128, 128, 130, 130, 128, 128, 126, 126, 128], [112, 144, 144, 112, 160, 160, 160, 160, 112, 112, 144, 144, 112, 112, 80, 80])
};

uint32_t
sobolowen::_scramble(uint32_t word, uint32_t seed)
{
  uint32_t x = seed * 0x6A935CA5; // this is our scrambling word
  uint32_t w = word; // this is a copy of the word to be scrambled, will decay as a result of the calculation
  uint32_t n = seed; // byte: contribution of scramble bits from the pre-baked tree

  // iteration 1
    n = scramble_table[n & 0xF][w >> 25];
    w <<= 8;
    x ^= n << 24;

  // iteration 2
    n = scramble_table[n & 0xF][w >> 25];
    w <<= 8;
    x ^= n << 16;

  // iteration 3
    n = scramble_table[n & 0xF][w >> 25];
    w <<= 8;
    x ^= n << 8;

  // iteration 4
    x ^= scramble_table[n & 0xF][w >> 25];

  return word ^ x;
}
